---
openapi: 3.1.0
info:
  contact:
    name: PowerCards Support
    url: https://github.com/victobonetti/powercards
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  title: PowerCards API
  version: 1.0.0
paths:
  /v1/ai/chat:
    post:
      requestBody:
        content:
          text/plain:
            schema:
              type: string
        required: true
      responses:
        "200":
          description: OK
          content:
            text/plain:
              schema:
                type: string
      summary: Chat
      tags:
      - AI Resource
  /v1/anki/upload:
    post:
      summary: Upload Anki package
      description: Uploads an .apkg file and returns the loaded decks.
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                force:
                  type: boolean
        required: true
      responses:
        "200":
          description: File uploaded successfully
          content:
            application/json:
              schema: {}
        "400":
          description: No file provided
      tags:
      - Anki Resource
  /v1/cards:
    get:
      summary: List all cards
      parameters:
      - name: deckId
        in: query
        schema:
          type: integer
          format: int64
      - name: page
        in: query
        schema:
          type: integer
          format: int32
          default: 1
      - name: perPage
        in: query
        schema:
          type: integer
          format: int32
          default: 20
      - name: search
        in: query
        schema:
          type: string
      - name: sort
        in: query
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedResponseCardResponse"
      tags:
      - Card Resource
    post:
      summary: Create a new card
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CardRequest"
        required: true
      responses:
        "201":
          description: Card created
        "400":
          description: Bad Request
      tags:
      - Card Resource
  /v1/cards/bulk/delete:
    post:
      summary: Bulk delete cards
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkDeleteRequest"
        required: true
      responses:
        "201":
          description: Created
        "400":
          description: Bad Request
      tags:
      - Card Resource
  /v1/cards/bulk/move:
    post:
      summary: Bulk move cards to deck
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkMoveRequest"
        required: true
      responses:
        "201":
          description: Created
        "400":
          description: Bad Request
      tags:
      - Card Resource
  /v1/cards/{id}:
    put:
      summary: Update an existing card
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CardRequest"
        required: true
      responses:
        "200":
          description: Card updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CardResponse"
        "404":
          description: Card not found
        "400":
          description: Bad Request
      tags:
      - Card Resource
    get:
      summary: Get a card by ID
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Card found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CardResponse"
        "404":
          description: Card not found
      tags:
      - Card Resource
    delete:
      summary: Delete a card
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "204":
          description: Card deleted
        "404":
          description: Card not found
      tags:
      - Card Resource
  /v1/chats:
    get:
      parameters:
      - name: X-Workspace-Id
        in: header
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Chat"
      summary: List Chats
      tags:
      - Chat Resource
    post:
      parameters:
      - name: X-Workspace-Id
        in: header
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Chat"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Chat"
        "400":
          description: Bad Request
      summary: Create Chat
      tags:
      - Chat Resource
  /v1/chats/{id}:
    delete:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: {}
      summary: Delete Chat
      tags:
      - Chat Resource
  /v1/chats/{id}/history:
    get:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          $ref: "#/components/schemas/UUID"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ChatHistory"
      summary: Get History
      tags:
      - Chat Resource
  /v1/chats/{id}/messages:
    post:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          $ref: "#/components/schemas/UUID"
      requestBody:
        content:
          text/plain:
            schema:
              type: string
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: {}
      summary: Send Message
      tags:
      - Chat Resource
  /v1/decks:
    get:
      summary: List all decks
      parameters:
      - name: page
        in: query
        schema:
          type: integer
          format: int32
          default: 1
      - name: perPage
        in: query
        schema:
          type: integer
          format: int32
          default: 20
      - name: search
        in: query
        schema:
          type: string
      - name: sort
        in: query
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedResponseDeckResponse"
      tags:
      - Deck Resource
    post:
      summary: Create a new deck
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeckRequest"
        required: true
      responses:
        "201":
          description: Deck created
        "400":
          description: Bad Request
      tags:
      - Deck Resource
  /v1/decks/{id}:
    put:
      summary: Update an existing deck
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DeckRequest"
        required: true
      responses:
        "200":
          description: Deck updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeckResponse"
        "404":
          description: Deck not found
        "400":
          description: Bad Request
      tags:
      - Deck Resource
    get:
      summary: Get a deck by ID
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Deck found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DeckResponse"
        "404":
          description: Deck not found
      tags:
      - Deck Resource
    delete:
      summary: Delete a deck
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "204":
          description: Deck deleted
        "404":
          description: Deck not found
      tags:
      - Deck Resource
  /v1/models:
    get:
      summary: List all Anki models
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/AnkiModelResponse"
      tags:
      - Anki Model Resource
    post:
      summary: Create a new Anki model
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AnkiModelRequest"
        required: true
      responses:
        "201":
          description: Model created
        "400":
          description: Bad Request
      tags:
      - Anki Model Resource
  /v1/models/{id}:
    put:
      summary: Update an existing Anki model
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AnkiModelRequest"
        required: true
      responses:
        "200":
          description: Model updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnkiModelResponse"
        "404":
          description: Model not found
        "400":
          description: Bad Request
      tags:
      - Anki Model Resource
    get:
      summary: Get an Anki model by ID
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Model found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AnkiModelResponse"
        "404":
          description: Model not found
      tags:
      - Anki Model Resource
    delete:
      summary: Delete an Anki model
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "204":
          description: Model deleted
        "404":
          description: Model not found
      tags:
      - Anki Model Resource
  /v1/notes:
    get:
      summary: List all notes
      parameters:
      - name: page
        in: query
        schema:
          type: integer
          format: int32
          default: 1
      - name: perPage
        in: query
        schema:
          type: integer
          format: int32
          default: 20
      - name: search
        in: query
        schema:
          type: string
      - name: sort
        in: query
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedResponseNoteResponse"
      tags:
      - Note Resource
    post:
      summary: Create a new note
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NoteRequest"
        required: true
      responses:
        "201":
          description: Note created
        "400":
          description: Bad Request
      tags:
      - Note Resource
  /v1/notes/bulk/delete:
    post:
      summary: Bulk delete notes
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkDeleteRequest"
        required: true
      responses:
        "201":
          description: Created
        "400":
          description: Bad Request
      tags:
      - Note Resource
  /v1/notes/bulk/tags:
    post:
      summary: Bulk add tags to notes
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/BulkTagRequest"
        required: true
      responses:
        "201":
          description: Created
        "400":
          description: Bad Request
      tags:
      - Note Resource
  /v1/notes/{id}:
    put:
      summary: Update an existing note
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NoteRequest"
        required: true
      responses:
        "200":
          description: Note updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NoteResponse"
        "404":
          description: Note not found
        "400":
          description: Bad Request
      tags:
      - Note Resource
    get:
      summary: Get a note by ID
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: Note found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NoteResponse"
        "404":
          description: Note not found
      tags:
      - Note Resource
    delete:
      summary: Delete a note
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "204":
          description: Note deleted
        "404":
          description: Note not found
      tags:
      - Note Resource
  /v1/notes/{id}/media:
    post:
      summary: Upload media for a note
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: {}
      tags:
      - Note Resource
  /v1/tags:
    get:
      summary: List tags
      parameters:
      - name: search
        in: query
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Tag"
      tags:
      - Tag Resource
    post:
      summary: Create a new tag
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Tag"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: {}
        "400":
          description: Bad Request
      tags:
      - Tag Resource
  /v1/tags/stats:
    get:
      summary: List tags with stats
      parameters:
      - name: page
        in: query
        schema:
          type: integer
          format: int32
          default: 1
      - name: perPage
        in: query
        schema:
          type: integer
          format: int32
          default: 20
      - name: search
        in: query
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedResponseTagStats"
      tags:
      - Tag Resource
  /v1/tags/{id}:
    delete:
      summary: Delete a tag
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "204":
          description: No Content
      tags:
      - Tag Resource
  /v1/workspaces:
    get:
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/WorkspaceResponse"
      summary: List
      tags:
      - Workspace Resource
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WorkspaceRequest"
        required: true
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema: {}
        "400":
          description: Bad Request
      summary: Create
      tags:
      - Workspace Resource
  /v1/workspaces/{id}:
    delete:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        "204":
          description: No Content
      summary: Delete
      tags:
      - Workspace Resource
components:
  schemas:
    AnkiFieldDto:
      type: object
      properties:
        name:
          type: string
        ordinal:
          type: integer
          format: int32
    AnkiModelRequest:
      type: object
      properties:
        name:
          type: string
        css:
          type: string
        fields:
          type: array
          items:
            $ref: "#/components/schemas/AnkiFieldDto"
        templates:
          type: array
          items:
            $ref: "#/components/schemas/AnkiTemplateDto"
    AnkiModelResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        css:
          type: string
        fields:
          type: array
          items:
            $ref: "#/components/schemas/AnkiFieldDto"
        templates:
          type: array
          items:
            $ref: "#/components/schemas/AnkiTemplateDto"
    AnkiTemplateDto:
      type: object
      properties:
        name:
          type: string
        questionFormat:
          type: string
        answerFormat:
          type: string
        ordinal:
          type: integer
          format: int32
    BulkDeleteRequest:
      type: object
      properties:
        ids:
          type: array
          items:
            type: integer
            format: int64
    BulkMoveRequest:
      type: object
      properties:
        cardIds:
          type: array
          items:
            type: integer
            format: int64
        targetDeckId:
          type: integer
          format: int64
    BulkTagRequest:
      type: object
      properties:
        noteIds:
          type: array
          items:
            type: integer
            format: int64
        tags:
          type: array
          items:
            type: string
    CardRequest:
      type: object
      properties:
        noteId:
          type: integer
          format: int64
        deckId:
          type: integer
          format: int64
        ordinal:
          type: integer
          format: int32
        modificationTimestamp:
          type: integer
          format: int64
        updateSequenceNumber:
          type: integer
          format: int32
        type:
          type: integer
          format: int32
        queue:
          type: integer
          format: int32
        due:
          type: integer
          format: int64
        interval:
          type: integer
          format: int32
        easeFactor:
          type: integer
          format: int32
        repetitions:
          type: integer
          format: int32
        lapses:
          type: integer
          format: int32
        remainingSteps:
          type: integer
          format: int32
        originalDue:
          type: integer
          format: int64
        originalDeckId:
          type: integer
          format: int64
        flags:
          type: integer
          format: int32
        customData:
          type: string
        noteContent:
          type: string
        noteTags:
          type: string
    CardResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        noteId:
          type: integer
          format: int64
        deckId:
          type: integer
          format: int64
        ordinal:
          type: integer
          format: int32
        modificationTimestamp:
          type: integer
          format: int64
        updateSequenceNumber:
          type: integer
          format: int32
        type:
          type: integer
          format: int32
        queue:
          type: integer
          format: int32
        due:
          type: integer
          format: int64
        interval:
          type: integer
          format: int32
        easeFactor:
          type: integer
          format: int32
        repetitions:
          type: integer
          format: int32
        lapses:
          type: integer
          format: int32
        remainingSteps:
          type: integer
          format: int32
        originalDue:
          type: integer
          format: int64
        originalDeckId:
          type: integer
          format: int64
        flags:
          type: integer
          format: int32
        customData:
          type: string
        noteField:
          type: string
        noteTags:
          type: string
    Chat:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        workspaceId:
          type: string
        name:
          type: string
        createdAt:
          $ref: "#/components/schemas/LocalDateTime"
        updatedAt:
          $ref: "#/components/schemas/LocalDateTime"
    ChatHistory:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        chat:
          $ref: "#/components/schemas/Chat"
        role:
          type: string
        content:
          type: string
        messageType:
          type: string
        createdAt:
          $ref: "#/components/schemas/LocalDateTime"
    DeckRequest:
      type: object
      properties:
        name:
          type: string
    DeckResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        cardCount:
          type: integer
          format: int64
    LocalDateTime:
      type: string
      format: date-time
      examples:
      - 2022-03-10T12:15:50
    NoteRequest:
      type: object
      properties:
        modelId:
          type: integer
          format: int64
        modificationTimestamp:
          type: integer
          format: int64
        updateSequenceNumber:
          type: integer
          format: int32
        tags:
          type: string
        fields:
          type: string
        sortField:
          type: string
        checksum:
          type: integer
          format: int64
        flags:
          type: integer
          format: int32
        customData:
          type: string
    NoteResponse:
      type: object
      properties:
        id:
          type: integer
          format: int64
        guid:
          type: string
        modelId:
          type: integer
          format: int64
        modificationTimestamp:
          type: integer
          format: int64
        updateSequenceNumber:
          type: integer
          format: int32
        tags:
          type: string
        fields:
          type: string
        sortField:
          type: string
        checksum:
          type: integer
          format: int64
        flags:
          type: integer
          format: int32
        customData:
          type: string
    PaginatedResponseCardResponse:
      type: object
      properties:
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
        data:
          type: array
          items:
            $ref: "#/components/schemas/CardResponse"
    PaginatedResponseDeckResponse:
      type: object
      properties:
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
        data:
          type: array
          items:
            $ref: "#/components/schemas/DeckResponse"
    PaginatedResponseNoteResponse:
      type: object
      properties:
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
        data:
          type: array
          items:
            $ref: "#/components/schemas/NoteResponse"
    PaginatedResponseTagStats:
      type: object
      properties:
        pagination:
          $ref: "#/components/schemas/PaginationMeta"
        data:
          type: array
          items:
            $ref: "#/components/schemas/TagStats"
    PaginationMeta:
      type: object
      properties:
        total:
          type: integer
          format: int64
        page:
          type: integer
          format: int32
        nextPageUri:
          type: string
        lastPageUri:
          type: string
    Tag:
      type: object
      properties:
        workspace:
          $ref: "#/components/schemas/Workspace"
        id:
          type: integer
          format: int64
        name:
          type: string
    TagStats:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        noteCount:
          type: integer
          format: int64
    UUID:
      type: string
      format: uuid
      pattern: "[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}"
    Workspace:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
    WorkspaceRequest:
      type: object
      properties:
        name:
          type: string
    WorkspaceResponse:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
servers:
- url: http://localhost:8088
  description: Auto generated value
- url: http://0.0.0.0:8088
  description: Auto generated value
